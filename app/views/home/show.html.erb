<% latest_goal = current_user.goals.order(updated_at: :desc).first %>

<% if latest_goal.present? %>
  <div class="mt-4 rounded-lg border bg-white p-4">
    <div class="flex items-center justify-between">
      <h3 class="text-sm font-semibold"><%= latest_goal.title %></h3>
      <span class="text-xs text-gray-500"><%= latest_goal.progress_ratio %>%</span>
    </div>
    <div class="mt-2 h-2 w-full overflow-hidden rounded bg-gray-200">
      <div class="h-2 bg-black" style="width:<%= latest_goal.progress_ratio %>%"></div>
    </div>
    <div class="mt-2 text-xs text-gray-500">
      <%= latest_goal.goal_tasks.completed.count %> / <%= latest_goal.goal_tasks.count %> 完了
    </div>
    <div class="mt-3 text-right">
      <%= link_to "目標をみる", goals_path, class: "text-sm underline" %>
      <%# 単一ゴール詳細に飛ばしたい場合は goal_path(latest_goal) でも可 %>
    </div>
  </div>
<% else %>
  <div class="mt-4 rounded-lg border bg-white p-4">
    <h3 class="text-sm font-semibold">目標</h3>
    <p class="mt-1 text-xs text-gray-500">まだ目標がありません。まずは1つ作ってみましょう。</p>
    <div class="mt-3 text-right">
      <%= link_to "目標を作成", new_goal_path, class: "text-sm underline" %>
    </div>
  </div>
<% end %>
