<%= form_with model: log, url: logs_path,
              data: { controller: "quick-logger" },
              html: { class: "space-y-4" } do |f| %>

  <div class="flex flex-wrap gap-2" data-quick-logger-target="categoryGroup">
    <% Log.categories.keys.each do |cat| %>
      <button type="button"
              class="px-3 py-2 min-h-[44px] rounded-full border text-sm"
              data-action="click->quick-logger#setCategory"
              data-category="<%= cat %>">
        <%= cat.titleize %>
      </button>
    <% end %>
  </div>

  <%= f.hidden_field :category, data: { quick_logger_target: "categoryField" } %>
  <%= f.hidden_field :minutes,  data: { quick_logger_target: "minutesField" } %>

  <div class="flex gap-2">
    <% [15,30,45,60].each do |m| %>
      <button type="button"
              class="px-3 py-3 min-h-[44px] rounded-md border inline-flex items-center justify-center gap-1.5"
              data-action="click->quick-logger#setMinutes"
              data-minutes="<%= m %>">
        <%= icon "clock", size: "w-4 h-4", "aria-hidden": "true" %> <span><%= m %>分</span>
      </button>
    <% end %>
  </div>

  <div>
    <%= f.text_area :memo,
          rows: 2,
          placeholder: "メモ（任意・Enterで送信）",
          class: "textarea",
          data: { quick_logger_target: "memoField", action: "keydown.enter->quick-logger:submitIfReady" } %>
  </div>

  <div>
    <span class="block text-sm font-medium text-gray-700 mb-1">公開範囲</span>
    <div class="flex gap-4">
      <% Log.visibilities.keys.each do |v| %>
        <label class="flex items-center gap-1 text-sm">
          <%= f.radio_button :visibility, v,
                checked: (log.visibility == v || (log.new_record? && v == "public")) %>
          <span><%= v.titleize %></span>
        </label>
      <% end %>
    </div>
  </div>

  <div class="text-right">
    <%= f.button class: "btn-primary w-full min-h-[44px] inline-flex items-center justify-center gap-1.5",
                 disabled: true,
                 data: { quick_logger_target: "submitButton" } do %>
      <%= icon "check", variant: :solid, size: "w-5 h-5", "aria-hidden": "true" %> <span>記録</span>
    <% end %>
  </div>
<% end %>
